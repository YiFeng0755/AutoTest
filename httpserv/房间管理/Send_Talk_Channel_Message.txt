*** Settings ***
Documentation     body为json格式，各个字段解释如下：
...
...               "UserID": \ 用户ID，字符串，可选字段，透传给客户端，标记发送消息的用户
...
...               "ToChannelID": 频道ID，字符串，必选字段，消息要发往的频道
...
...               "Msg": \ 消息内容，字符串，必选字段，长度不要超过2048字节
...
...               "MsgID": \ 消息ID，整数，可选字段，透传给客户端，区分消息
...
...
...
...               {
...               "UserID": "admin",
...               "ToChannelID": "ch#001",
...               "Msg": "测试消息",
...               "MsgID": 10000
...               }
Force Tags        Send_Talk_Channel_Message
Default Tags      talk
Library           RequestsLibrary
Library           Collections
Library           ../lib/YouMeAnchorRankLib.py
Library           ../lib/YouMeRequestLib.py

*** Variables ***
${SECRET}         uQAuo9xbYOevRl7oyTm0kR60WMoLDmIzgucehu8lkV0Y2ZKOEP84Y5cWyliGlns0nJK2kgDDGEsCsi/SUWnn0jKQ0REteItDMn/5rihp+Dd8I0V1FMcMeXTSPWDcV+lTiF9so2bpIpLsMlUdHGUVkUMIdUv6vgmtZflkfALM6AMBAAE=    # 用于sha1加密的 秘钥
${APPKEY}         YOUME3C8DDD417211056AAEC1A518FBA43F34577EC958    # 应用标识
${URL}            http://106.75.14.78:18080/

*** Test Cases ***
向Talk频道发送文本消息
    [Documentation]    body实例
    ...
    ...    {
    ...    "UserID": "admin",
    ...    "ToChannelID": "ch#001",
    ...    "Msg": "测试消息",
    ...    "MsgID": 10000
    ...    }
    [Tags]    smoke
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${data}    Create Dictionary    UserID=admin    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70093

UserID为空
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${data}    Create Dictionary    UserID=    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70093

ToChannelID为空
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${data}    Create Dictionary    UserID=admin    ToChannelID=    Msg=测试消息    MsgID=${MsgID}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70093

Msg长度为2048字节
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${Msg}    Convert To Integer    2048
    ${MsgID1}    randomstr    ${Msg}
    ${data}    Create Dictionary    UserID=admin    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID1}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70001

Msg长度超过2048字节
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${MsgID1}    randomstr    ${MsgID}
    ${data}    Create Dictionary    UserID=admin    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID1}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70001

Msg长度少于2048字节
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${MsgID1}    randomstr    ${MsgID}
    ${data}    Create Dictionary    UserID=admin    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID1}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70001

Msg为空
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${data}    Create Dictionary    UserID=admin    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70093

MsgID为空
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${data}    Create Dictionary    UserID=admin    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70093

body为空
    log    Send_Talk_Channel_Message
    ${MsgID}    Convert To Integer    10000
    ${data}    Create Dictionary    UserID=admin    ToChannelID=ch#001    Msg=测试消息    MsgID=${MsgID}
    ${res1}    Post Data    ${URL}    v1/im/send_talk_channel_message    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70093
