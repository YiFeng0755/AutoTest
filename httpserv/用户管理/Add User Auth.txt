*** Settings ***
Force Tags        Add User Auth
Default Tags      Auth
Library           RequestsLibrary
Library           Collections
Library           ../lib/YouMeAnchorRankLib.py
Library           ../lib/YouMeRequestLib.py

*** Variables ***
${SECRET}         uQAuo9xbYOevRl7oyTm0kR60WMoLDmIzgucehu8lkV0Y2ZKOEP84Y5cWyliGlns0nJK2kgDDGEsCsi/SUWnn0jKQ0REteItDMn/5rihp+Dd8I0V1FMcMeXTSPWDcV+lTiF9so2bpIpLsMlUdHGUVkUMIdUv6vgmtZflkfALM6AMBAAE=    # 用于sha1加密的 秘钥
${APPKEY}         YOUME3C8DDD417211056AAEC1A518FBA43F34577EC958    # 应用标识
${URL}            http://106.75.14.78:18080/

*** Test Cases ***
添加认证用户
    [Documentation]    body：
    ...    {
    ...    "UserList":[
    ...    {
    ...    "UserID":"user1",
    ...    "NickName":"user123",
    ...    "Token":"123456"
    ...    },
    ...    {
    ...    "UserID":"user2",
    ...    "NickName":"user1234",
    ...    "Token":"12345"
    ...    }]
    ...    }
    [Tags]    User    smoke
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=user1001    NickName=currryhaha    Token=123456
    ${user2}    Create Dictionary    UserID=user1002    NickName=makaha    Token=123456
    ${userlist}    Create List    ${user1}    ${user2}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

UserList为字典
    Log    "add_user_auth"
    ${data}    Create Dictionary    UserID=user1
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL

UserList为空
    Log    "add_user_auth"
    ${data}    Create Dictionary    UserID=
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL

UserID个数为0
    Log    "add_user_auth"
    ${user1}    Create Dictionary
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0

UserID个数小于最大值
    Log    "add_user_auth"
    ${num}    Convert To Integer    99
    ${UserList}    Create User Auth N List    ${num}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0

UserID个数为最大值100
    Log    "add_user_auth"
    ${num}    Convert To Integer    100
    ${UserList}    Create User Auth N List    ${num}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0

UserID个数大于最大值
    Log    "add_user_auth"
    ${num}    Convert To Integer    101
    ${UserList}    Create User Auth N List    ${num}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0

UserID为空
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=    NickName=currryhaha    Token=123456
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

UserID超过300字符
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=jhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjk    NickName=currryhaha    Token=123456
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

NickName为空
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=user123    NickName=    Token=123456
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

NickName超过300字符
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=user1001    NickName=jhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjk    Token=123456
    ${user2}    Create Dictionary    UserID=user1002    NickName=makaha    Token=123456
    ${userlist}    Create List    ${user1}    ${user2}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

Token为空
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=user1001    NickName=currryhaha    Token=
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

Token超过300字符
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=user1001    NickName=currryhaha    Token=jhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjkjhjhjkjkjkjkjkjkjkjk
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

Token为多种类型组合
    Log    "add_user_auth"
    ${Token}    Convert To Bytes    abc123$%^
    ${user1}    Create Dictionary    UserID=user1001    NickName=currryhaha    Token=${Token}
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

body为空
    Log    "add_user_auth"
    ${user1}    Create Dictionary
    ${user2}    Create Dictionary
    ${userlist}    Create List    ${user1}    ${user2}
    ${data}    Create Dictionary    UserList=${userlist}
    log    ${data}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK

添加用户删除用户再添加用户
    #添加用户
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=user1001    NickName=currryhaha    Token=123456
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Delete User Auth    user1001
    #添加用户
    Log    "add_user_auth"
    ${user1}    Create Dictionary    UserID=user1001    NickName=currryhaha    Token=123456
    ${userlist}    Create List    ${user1}
    ${data}    Create Dictionary    UserList=${userlist}
    ${res1}    Post Data    ${URL}    v1/im/add_user_auth    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Get From Dictionary    ${res1}    UserList

*** Keywords ***
Delete User Auth
    [Arguments]    ${UserID}
    ${UserID1}    Create Dictionary    UserID=${UserID}
    ${UserList}    Create List    ${UserID1}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/delete_user_auth    ${data}
