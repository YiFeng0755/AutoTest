*** Settings ***
Documentation     批量获取用户在线状态信息
...
...               "UserList" \ : \ \ 批量认证用户列表(一次不超过100个用户)，包括以下属性：
...               "UserID" \ \ ： \ 用户ID，app内唯一，字符串
Force Tags        Query Im User State
Default Tags      state
Library           RequestsLibrary
Library           Collections
Library           ../lib/YouMeRequestLib.py
Library           ../lib/YouMeAnchorRankLib.py

*** Variables ***
${SECRET}         uQAuo9xbYOevRl7oyTm0kR60WMoLDmIzgucehu8lkV0Y2ZKOEP84Y5cWyliGlns0nJK2kgDDGEsCsi/SUWnn0jKQ0REteItDMn/5rihp+Dd8I0V1FMcMeXTSPWDcV+lTiF9so2bpIpLsMlUdHGUVkUMIdUv6vgmtZflkfALM6AMBAAE=    # 用于sha1加密的 秘钥
${APPKEY}         YOUME3C8DDD417211056AAEC1A518FBA43F34577EC958    # 应用标识
${URL}            http://106.75.14.78:18080/

*** Test Cases ***
获取用户在线状态
    [Documentation]    {
    ...    \ \ \ \ \ \ \ \ \ "UserList":[
    ...    {
    ...    "UserID":"user1"
    ...    },
    ...    {
    ...    "UserID":"user2"
    ...    }]
    ...    }
    [Tags]    state    smoke
    Log    query_im_user_state
    ${User1}    Create Dictionary    UserID=user1
    ${User2}    Create Dictionary    UserID=user2
    ${UserList}    Create List    ${User1}    ${User2}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserList为空
    Log    query_im_user_state
    #${User1}    Create Dictionary    UserID=user1
    #${User2}    Create Dictionary    UserID=user2
    ${UserList}    Create List
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70002

UserID为空
    Log    query_im_user_state
    ${user1}    Create Dictionary    UserID=
    ${user2}    Create Dictionary    UserID=
    ${userlist}    Create List    ${user1}    ${user2}
    ${data}    Create Dictionary    UserList=${userlist}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID不存在
    #获取用户状态_无userID    #待确认
    Log    query_im_user_state
    ${user1}    Create Dictionary
    ${user2}    Create Dictionary
    ${userlist}    Create List    ${user1}    ${user2}
    ${data}    Create Dictionary    UserList=${userlist}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID个数少于最大值
    #获取用户在线状态_用户长度有效
    Log    query_im_user_state
    ${num}    Convert To Integer    99
    ${str}    Convert To String    user
    ${userlist}    create_query_im_user_state_n_List    ${num}    ${str}
    ${data}    Create Dictionary    UserList=${userlist}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID个数为最大值
    #获取用户在线状态_用户长度有效1
    Log    create_query_im_user_state_List
    ${num}    Convert To Integer    100
    ${str}    Convert To String    YOUME
    ${userlist}    create_query_im_user_state_n_List    ${num}    ${str}
    ${data}    Create Dictionary    UserList=${userlist}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID个数大于最大值
    #获取用户在线状态_用户长度无效    #待确认
    Log    query_im_user_state
    ${num}    Convert To Integer    101
    ${str}    Convert To String    YOUME
    ${userlist}    create_query_im_user_state_n_List    ${num}    ${str}
    ${data}    Create Dictionary    UserList=${userlist}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID值为整数
    Log    query_im_user_state
    ${user1}    Convert To Integer    100
    ${user2}    Convert To Integer    90
    ${UserID1}    Create Dictionary    UserID=${user1}
    ${UserID2}    Create Dictionary    UserID=${user2}
    ${UserList}    Create List    ${UserID1}    ${UserID2}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID值为浮点数
    Log    query_im_user_state
    ${user1}    Evaluate    float(10.5)
    ${user2}    Evaluate    float(11.5)
    ${UserID1}    Create Dictionary    UserID=${user1}
    ${UserID2}    Create Dictionary    UserID=${user2}
    ${UserList}    Create List    ${UserID1}    ${UserID2}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID值为特殊字符
    Log    query_im_user_state
    ${user1}    Convert To Bytes    $%^&
    ${user2}    Convert To Bytes    $%^&*
    ${UserID1}    Create Dictionary    UserID=${user1}
    ${UserID2}    Create Dictionary    UserID=${user2}
    ${UserList}    Create List    ${UserID1}    ${UserID2}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID值为负数
    Log    query_im_user_state
    ${user1}    Convert To Integer    -100
    ${user2}    Convert To Integer    -50
    ${UserID1}    Create Dictionary    UserID=${user1}
    ${UserID2}    Create Dictionary    UserID=${user2}
    ${UserList}    Create List    ${UserID1}    ${UserID2}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID值长度超过500
    Log    query_im_user_state
    ${user1}    Convert To Integer    1234567890123432123412345678901234321234123456789012343212341234567890123432123412345678901234321234234567890123432123412345678901234321234123456789012343212341234567890123432123412345678901234321234123456789012343212341234567890123432123412345678901234321234123456789012343212341234567890123432123412345678901234321234457812345678945784578457845784578112585874458774599877456587745952544478964478644445546548898767255425742875865885577272575757587537546754768576567576576123432123412345678901234321234123456789012343212341234567890123432123412345678901234321234123456789012343212341234567890123432123412345678901234321234123456789012343212344578
    ${UserID1}    Create Dictionary    UserID=${user1}
    ${UserList}    Create List    ${UserID1}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70001

UserID中间有空格
    Log    query_im_user_state
    ${user1}    Convert To Integer    10 20 30
    ${UserID1}    Create Dictionary    UserID=${user1}
    ${UserList}    Create List    ${UserID1}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

UserID存在多种类型组合
    Log    query_im_user_state
    ${user1}    Convert To Bytes    123abc#$%
    ${UserID1}    Create Dictionary    UserID=${user1}
    ${UserList}    Create List    ${UserID1}
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    OK
    Dictionary should contain Item    ${res1}    ErrorCode    0
    Dictionary should contain Key    ${res1}    QueryResult

body为空
    Log    query_im_user_state
    ${UserList}    Create List
    ${data}    Create Dictionary    UserList=${UserList}
    ${res1}    Post Data    ${URL}    v1/im/query_im_user_state    ${data}
    Dictionary should contain Item    ${res1}    ActionStatus    FAIL
    Dictionary should contain Item    ${res1}    ErrorCode    70002
